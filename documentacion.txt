# Twins TÃ©cnicos - DocumentaciÃ³n Completa del Proyecto

## ğŸ“‹ Resumen del Proyecto
Sistema de gestiÃ³n de mantenimiento de sistemas contra incendios. Permite gestionar clientes, programar visitas preventivas, manejar tareas correctivas y trabajar offline desde dispositivos mÃ³viles.

## ğŸ—ï¸ Estructura del Proyecto

```
twins-tecnicos/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ layout.js                 âœ… Layout principal con AuthProvider
â”‚   â”‚   â”œâ”€â”€ page.js                   âœ… PÃ¡gina de inicio (redirecciÃ³n)
â”‚   â”‚   â”œâ”€â”€ login/page.js             âœ… Login con email/password y Google
â”‚   â”‚   â”œâ”€â”€ register/page.js          âœ… Registro de usuarios
â”‚   â”‚   â”œâ”€â”€ dashboard/page.js         âœ… Panel de control principal
â”‚   â”‚   â””â”€â”€ clients/
â”‚   â”‚       â”œâ”€â”€ page.js               âœ… Lista de clientes con tabla y buscador
â”‚   â”‚       â”œâ”€â”€ new/page.js           âœ… Formulario crear cliente
â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚           â”œâ”€â”€ page.js           âœ… Detalle del cliente
â”‚   â”‚           â””â”€â”€ edit/page.js      âœ… Formulario editar cliente
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.js         âœ… ProtecciÃ³n de rutas autenticadas
â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚       â””â”€â”€ DashboardLayout.js    âœ… Layout con navegaciÃ³n y sidebar
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ contexts/
â”‚       â”‚   â””â”€â”€ AuthContext.js        âœ… Context de autenticaciÃ³n
â”‚       â””â”€â”€ firebase/
â”‚           â”œâ”€â”€ config.js             âœ… ConfiguraciÃ³n de Firebase
â”‚           â”œâ”€â”€ firebase.js           âœ… InicializaciÃ³n de Firebase
â”‚           â””â”€â”€ operations.js         âœ… Operaciones CRUD completas
â”œâ”€â”€ .env.local                        âœ… Variables de entorno
â””â”€â”€ package.json                      âœ… Dependencias instaladas
```

## ğŸ”§ Stack TecnolÃ³gico
- **Frontend**: Next.js 14 (App Router), JavaScript (sin TypeScript)
- **Styling**: Tailwind CSS
- **Icons**: Lucide React
- **Backend**: Firebase (Auth + Firestore)
- **Futuro**: PWA con next-pwa para funcionalidad offline

## ğŸ”‘ Variables de Entorno (.env.local)
```bash
# Firebase Configuration
NEXT_PUBLIC_FIREBASE_API_KEY=tu-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=tu-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=tu-project-id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=tu-project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789
NEXT_PUBLIC_FIREBASE_APP_ID=tu-app-id
```

## ğŸ“Š Estructura de Datos en Firestore

### ColecciÃ³n: `clients`
```javascript
{
  companyName: "Empresa 1",              // Nombre de la empresa
  referentName: "Juan PÃ©rez",            // Nombre del referente
  referentPosition: "Jefe Mantenimiento", // Cargo del referente
  address: "Direccion 123",              // DirecciÃ³n fÃ­sica
  contractRef: "CONT-2025-001",          // Referencia del contrato
  reportEmails: ["email1@empresa.com"],  // Array de correos para informes
  frequency: "monthly",                  // weekly, monthly, bimonthly
  createdAt: timestamp,
  updatedAt: timestamp
}
```

### ColecciÃ³n: `visits` (preventivas)
```javascript
{
  clientId: "client_id",                 // Referencia al cliente
  scheduledDate: timestamp,              // Fecha programada
  status: "scheduled",                   // scheduled, completed
  completedDate: timestamp,              // Fecha de completado
  technicians: ["Juan", "MarÃ­a"],        // Array de tÃ©cnicos presentes
  notes: "Observaciones",                // Notas de la visita
  photos: [],                           // Array de URLs de fotos
  createdAt: timestamp,
  updatedAt: timestamp
}
```

### ColecciÃ³n: `corrective_tasks` (correctivas)
```javascript
{
  clientId: "client_id",                 // Referencia al cliente
  originVisitId: "visit_id",             // ID de la visita donde surgiÃ³
  description: "Extintor vencido",       // DescripciÃ³n del problema
  priority: "urgent",                    // urgent, normal, next_visit
  status: "pending",                     // pending, in_progress, completed
  reportedDate: timestamp,               // Fecha cuando se detectÃ³
  completedDate: timestamp,              // Fecha de completado
  reportedBy: "TÃ©cnico",                // Quien reportÃ³
  completedBy: ["TÃ©cnico1"],            // Array de quien completÃ³
  notes: "Observaciones",               // Notas adicionales
  photos: [],                          // Array de URLs de fotos
  createdAt: timestamp,
  updatedAt: timestamp
}
```

### ColecciÃ³n: `users`
```javascript
{
  name: "Juan PÃ©rez",
  email: "juan@empresa.com",
  role: "admin" // o "technician"
}
```

## ğŸ¨ Convenciones de DiseÃ±o

### Colores en la NavegaciÃ³n
- **Panel de Control**: Azul (`text-blue-600`)
- **Clientes**: Verde (`text-green-600`)
- **Visitas**: Morado (`text-purple-600`)
- **Tareas Pendientes**: Naranja (`text-orange-600`)

### Iconos Lucide Utilizados
- **LayoutDashboard**: Panel de Control
- **Users**: Clientes
- **Calendar**: Visitas
- **AlertTriangle**: Tareas Pendientes
- **Eye**: Ver detalle
- **Edit**: Editar
- **Trash2**: Eliminar
- **Menu/X**: NavegaciÃ³n mÃ³vil
- **LogOut**: Cerrar sesiÃ³n

### Estados y Prioridades
**Estados de visitas**: `scheduled`, `completed`
**Estados de tareas**: `pending`, `in_progress`, `completed`
**Prioridades**: `urgent`, `normal`, `next_visit`
**Frecuencias**: `weekly`, `monthly`, `bimonthly`

## ğŸ“± Funcionalidades Implementadas

### âœ… AutenticaciÃ³n
- Login con email/contraseÃ±a
- Login con Google
- Registro de usuarios
- ProtecciÃ³n de rutas
- Context de usuario global

### âœ… GestiÃ³n de Clientes (CRUD Completo)
- **Crear**: Formulario completo con validaciones
- **Leer**: Lista con tabla, bÃºsqueda y detalle completo
- **Actualizar**: Formulario de ediciÃ³n pre-cargado
- **Eliminar**: Con confirmaciÃ³n

### âœ… Dashboard
- EstadÃ­sticas generales
- PrÃ³ximas visitas (mock data)
- Tareas urgentes (mock data)
- NavegaciÃ³n con sidebar responsive

### âœ… UI/UX
- Responsive design (mobile-first)
- Sidebar colapsible en mÃ³vil
- Iconos profesionales con Lucide
- Estados de carga y errores
- Confirmaciones para acciones destructivas

## ğŸ”„ Flujo de Trabajo Planificado

### Visitas Preventivas
1. **Programar visita**: Admin crea visita para cliente especÃ­fico
2. **TÃ©cnico en campo**: Ve sus visitas del dÃ­a en mÃ³vil
3. **Realizar inspecciÃ³n**: Marca como completada, aÃ±ade notas/fotos
4. **Detectar problemas**: Si encuentra issues, crea tarea correctiva automÃ¡ticamente

### Tareas Correctivas
1. **Originadas de visitas**: Se crean automÃ¡ticamente cuando se detectan problemas
2. **Manuales**: Admin puede crear directamente
3. **AsignaciÃ³n flexible**: Cualquier tÃ©cnico puede tomar cualquier tarea
4. **Seguimiento**: Estados claros de progreso

## ğŸ“‹ PrÃ³ximos Pasos Pendientes

### ğŸ¯ Alta Prioridad
1. **GestiÃ³n de Visitas**
   - `/visits` - Lista de todas las visitas
   - `/visits/new` - Programar nueva visita
   - `/visits/[id]` - Completar visita (formulario para tÃ©cnicos)

2. **GestiÃ³n de Tareas Correctivas**
   - `/corrective-tasks` - Lista de tareas pendientes
   - `/corrective-tasks/[id]` - Completar tarea
   - `/corrective-tasks/new` - Crear tarea manual

3. **Conectar Dashboard con datos reales**
   - Reemplazar mock data con consultas a Firebase
   - EstadÃ­sticas dinÃ¡micas

### ğŸ¯ Media Prioridad
4. **Formulario de Completar Visita**
   - Checklist de inspecciÃ³n
   - Subida de fotos
   - CreaciÃ³n automÃ¡tica de tareas correctivas

5. **Calendario de Visitas**
   - Vista de calendario mensual/semanal
   - Drag & drop para reprogramar

### ğŸ¯ Baja Prioridad
6. **PWA y Funcionalidad Offline**
   - Configurar next-pwa
   - Service workers
   - SincronizaciÃ³n offline

7. **Reportes y ExportaciÃ³n**
   - PDFs de informes
   - EnvÃ­o automÃ¡tico por email

## ğŸš€ Comandos Importantes
```bash
# Desarrollo
npm run dev

# Instalar dependencias nuevas
npm install [package-name]

# Dependencias ya instaladas
npm install firebase lucide-react
```

## ğŸ”§ ConfiguraciÃ³n Firebase

### Reglas de Firestore
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
```

### Authentication Habilitado
- âœ… Email/Password
- âœ… Google

## ğŸ“ Notas TÃ©cnicas

### Manejo de Errores
- Todas las operaciones Firebase tienen try/catch
- Mensajes de error user-friendly
- Estados de loading en formularios

### Ordenamiento de Datos
- Se evitan orderBy complejos en Firestore para prevenir errores de Ã­ndices
- Ordenamiento se hace en el cliente (JavaScript) cuando es necesario

### Responsive Design
- Mobile-first approach
- Sidebar colapsible en pantallas pequeÃ±as
- Tablas con scroll horizontal en mÃ³vil

## ğŸ¯ Objetivos del Proyecto
- **Primario**: Sistema funcional para gestionar mantenimiento contra incendios
- **Secundario**: Acceso mÃ³vil para tÃ©cnicos en campo
- **Futuro**: Funcionalidad offline completa

---

## ğŸ“ Contacto del Desarrollo
Este proyecto fue desarrollado paso a paso con documentaciÃ³n detallada. Cada archivo incluye comentarios con su ubicaciÃ³n para facilitar el mantenimiento.

**Ãšltima actualizaciÃ³n**: 30 de Mayo, 2025
**Estado**: CRUD de Clientes completo âœ…
**Siguiente**: Implementar gestiÃ³n de Visitas